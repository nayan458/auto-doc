# Creating a Global Git Auto-Documentation Command

## Overview

This guide shows how to create a globally installable Git command that generates documentation for any repository.

## Project Structure

```
git-autodoc/
‚îú‚îÄ‚îÄ git-autodoc              # Main executable
‚îú‚îÄ‚îÄ script.sh                # README collection script
‚îú‚îÄ‚îÄ frontend/                # Your public frontend files
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ install.sh               # Installation script
‚îî‚îÄ‚îÄ README.md
```

## Step 1: Create the Main Command

**File: `git-autodoc`**

```bash
#!/bin/bash

set -e  # Exit on error

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPO_URL="https://github.com/YOUR_USERNAME/git-autodoc.git"
TEMP_DIR="/tmp/git-autodoc-$$"

echo "üöÄ Git Auto-Documentation Tool"
echo "================================"

# Check if we're in a git repository
if ! git rev-parse --git-dir > /dev/null 2>&1; then
    echo "‚ùå Error: Not a git repository"
    exit 1
fi

# Step 1: Create branch
echo ""
echo "üìù Step 1: Creating branch 'project/doc'..."
if git show-ref --verify --quiet refs/heads/project/doc; then
    echo "‚ö†Ô∏è  Branch 'project/doc' already exists. Switching to it..."
    git checkout project/doc
else
    git checkout -b project/doc
    echo "‚úÖ Branch created and checked out"
fi

# Step 2: Clone/pull the frontend repo
echo ""
echo "üì¶ Step 2: Fetching documentation generator..."
if [ -d "$TEMP_DIR" ]; then
    rm -rf "$TEMP_DIR"
fi

git clone --depth 1 "$REPO_URL" "$TEMP_DIR"
echo "‚úÖ Documentation tools downloaded"

# Step 3: Copy script to current repo
echo ""
echo "üìã Step 3: Setting up documentation scripts..."
cp "$TEMP_DIR/script.sh" ./
chmod +x ./script.sh
echo "‚úÖ Scripts ready"

# Step 4: Run the script
echo ""
echo "üîç Step 4: Collecting README files..."
./script.sh

if [ ! -d "collected-readmes" ] || [ ! -f "nav.json" ]; then
    echo "‚ùå Error: Script failed to generate required files"
    exit 1
fi
echo "‚úÖ Documentation collected"

# Step 5: Copy frontend files
echo ""
echo "üé® Step 5: Setting up documentation viewer..."
if [ -d "doc-viewer" ]; then
    rm -rf doc-viewer
fi

mkdir -p doc-viewer
cp -r "$TEMP_DIR/frontend/"* doc-viewer/
echo "‚úÖ Viewer setup complete"

# Step 6: Move files and commit
echo ""
echo "üíæ Step 6: Committing documentation..."

# Add all generated files
git add collected-readmes/
git add nav.json
git add doc-viewer/
git add script.sh

# Commit
git commit -m "docs: Generate project documentation

- Collected README files from project
- Generated navigation structure
- Added documentation viewer frontend

Generated by git-autodoc
" || echo "‚ö†Ô∏è  No changes to commit"

# Cleanup
rm -rf "$TEMP_DIR"
rm ./script.sh

echo ""
echo "================================"
echo "‚úÖ Documentation generation complete!"
echo ""
echo "üìÅ Generated files:"
echo "   - collected-readmes/  (All README files)"
echo "   - nav.json           (Navigation structure)"
echo "   - doc-viewer/        (Frontend viewer)"
echo ""
echo "üåø Branch: project/doc"
echo ""
echo "Next steps:"
echo "  1. Review changes: git status"
echo "  2. Push to remote: git push origin project/doc"
echo "  3. View docs: cd doc-viewer && npm install && npm start"
echo ""
```

## Step 2: Create the Collection Script

**File: `script.sh`**

```bash
#!/bin/bash

# Create output directory
OUTPUT_DIR="collected-readmes"
mkdir -p "$OUTPUT_DIR"

# Function to check if path should be ignored
should_ignore() {
    local path="$1"
    
    if [[ ! -f .readmeIgnore ]]; then
        return 1
    fi
    
    while IFS= read -r pattern || [[ -n "$pattern" ]]; do
        [[ -z "$pattern" || "$pattern" =~ ^[[:space:]]*# ]] && continue
        pattern=$(echo "$pattern" | xargs)
        if [[ "$path" == *"$pattern"* ]]; then
            return 0
        fi
    done < .readmeIgnore
    
    return 1
}

# Find and copy README files
echo "Collecting README files..."
find . -type f -iname "README.md" | while read -r file; do
    if should_ignore "$file"; then
        echo "  Skipping: $file"
        continue
    fi
    
    dest="$OUTPUT_DIR/${file#./}"
    mkdir -p "$(dirname "$dest")"
    cp "$file" "$dest"
    echo "  Copied: $file"
done

# Generate nav.json
echo ""
echo "Generating navigation..."

echo "{" > nav.json

first=true
find "$OUTPUT_DIR" -type f -iname "README.md" | sort | while read -r file; do
    dir_path=$(dirname "$file")
    folder_name=$(basename "$dir_path")
    rel_path="${file#$OUTPUT_DIR/}"
    
    if [[ "$folder_name" == "$OUTPUT_DIR" ]]; then
        folder_name="root"
        rel_path="README.md"
    fi
    
    if [[ "$first" == true ]]; then
        first=false
    else
        echo "," >> nav.json
    fi
    
    echo -n "  \"$folder_name\": \"@readmes/$rel_path\"" >> nav.json
done

echo "" >> nav.json
echo "}" >> nav.json

echo ""
echo "‚úÖ Collection complete!"
echo "  - README files: $OUTPUT_DIR/"
echo "  - Navigation: nav.json"
```

## Step 3: Create Installation Script

**File: `install.sh`**

```bash
#!/bin/bash

set -e

INSTALL_DIR="$HOME/.local/bin"
REPO_URL="https://github.com/YOUR_USERNAME/git-autodoc.git"

echo "üì¶ Installing git-autodoc..."
echo ""

# Create install directory if it doesn't exist
mkdir -p "$INSTALL_DIR"

# Clone or update repository
if [ -d "$HOME/.git-autodoc" ]; then
    echo "Updating existing installation..."
    cd "$HOME/.git-autodoc"
    git pull
else
    echo "Installing git-autodoc..."
    git clone "$REPO_URL" "$HOME/.git-autodoc"
fi

# Link the command
ln -sf "$HOME/.git-autodoc/git-autodoc" "$INSTALL_DIR/git-autodoc"
chmod +x "$INSTALL_DIR/git-autodoc"

# Check if directory is in PATH
if [[ ":$PATH:" != *":$INSTALL_DIR:"* ]]; then
    echo ""
    echo "‚ö†Ô∏è  $INSTALL_DIR is not in your PATH"
    echo ""
    echo "Add this to your ~/.bashrc or ~/.zshrc:"
    echo "    export PATH=\"\$HOME/.local/bin:\$PATH\""
    echo ""
fi

echo ""
echo "‚úÖ Installation complete!"
echo ""
echo "Usage: git autodoc"
echo ""
```

## Step 4: Publish to GitHub

Create a repository called `git-autodoc` on GitHub with this structure:

```bash
# Initialize repository
git init
git add .
git commit -m "Initial commit: Git Auto-Documentation tool"
git branch -M main
git remote add origin https://github.com/YOUR_USERNAME/git-autodoc.git
git push -u origin main
```

## Step 5: Installation Instructions (for users)

**One-line installation:**

```bash
curl -fsSL https://raw.githubusercontent.com/YOUR_USERNAME/git-autodoc/main/install.sh | bash
```

**Manual installation:**

```bash
# Clone repository
git clone https://github.com/YOUR_USERNAME/git-autodoc.git ~/.git-autodoc

# Add to PATH
echo 'export PATH="$HOME/.git-autodoc:$PATH"' >> ~/.bashrc
source ~/.bashrc

# Make executable
chmod +x ~/.git-autodoc/git-autodoc
```

## Usage

Anyone can now use your command:

```bash
# Navigate to any git repository
cd /path/to/any/repo

# Run the command
git autodoc
```

## Example README.md for Your Repository

````markdown
# git-autodoc

Automatically generate comprehensive documentation for any Git repository.

## Installation

```bash
curl -fsSL https://raw.githubusercontent.com/YOUR_USERNAME/git-autodoc/main/install.sh | bash
```

## Usage

```bash
cd your-project
git autodoc
```

This will:
1. Create a `project/doc` branch
2. Collect all README files from your project
3. Generate a navigation structure (`nav.json`)
4. Set up a documentation viewer frontend
5. Commit everything to the branch

## Features

- üîç Automatically finds all README files
- üìÅ Preserves directory structure
- üé® Includes beautiful documentation viewer
- üö´ Respects `.readmeIgnore` file
- üåø Creates isolated documentation branch

## Configuration

Create a `.readmeIgnore` file to exclude paths:

```
node_modules
.git
dist
build
```

## Requirements

- Git
- Bash
- Internet connection (first run only)

## License

MIT
````

## Distribution Options

### Option 1: NPM Package (Recommended for Node.js users)

Create `package.json`:

```json
{
  "name": "git-autodoc",
  "version": "1.0.0",
  "bin": {
    "git-autodoc": "./git-autodoc"
  },
  "scripts": {
    "postinstall": "chmod +x ./git-autodoc"
  }
}
```

Users install with:
```bash
npm install -g git-autodoc
```

### Option 2: Homebrew (for macOS/Linux)

Create a Homebrew formula for easier distribution.

### Option 3: Direct Download

Users can download and install manually from GitHub releases.

## Tips for Global Distribution

1. **Version your releases** - Use Git tags (v1.0.0, v1.1.0, etc.)
2. **Add error handling** - Check for dependencies
3. **Cross-platform support** - Test on Linux, macOS, Windows (Git Bash)
4. **Documentation** - Write clear README with examples
5. **CI/CD** - Use GitHub Actions to test on multiple platforms
6. **Changelog** - Maintain CHANGELOG.md
7. **License** - Add MIT or Apache 2.0 license

Would you like me to help you set up any specific part of this system?